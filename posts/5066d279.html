<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>前端常用代码块 | 爱笑的猫</title><meta name="description" content="前端常用代码块或JS             适配基础知识 1.什么是rem  CSS3新增的一个相对单位rem（root em,根em）.rem是相对于根节点（或者是html节点）.  如果根节点设置了font-size:10px;那么font-size:1.2rem;字体大小等于12px  2.什么是dpr  dpr就是设备物理像素与逻辑像素(css像素)的比例."><meta name="keywords" content="codeBlock"><meta name="author" content="爱笑的猫"><meta name="copyright" content="爱笑的猫"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/cat.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="Okne2Cvq0YtbUrg6H0tMdVDZYY9pofkaqn2_NbmHqoY"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="前端常用代码块"><meta name="twitter:description" content="前端常用代码块或JS             适配基础知识 1.什么是rem  CSS3新增的一个相对单位rem（root em,根em）.rem是相对于根节点（或者是html节点）.  如果根节点设置了font-size:10px;那么font-size:1.2rem;字体大小等于12px  2.什么是dpr  dpr就是设备物理像素与逻辑像素(css像素)的比例."><meta name="twitter:image" content="https://i.loli.net/2020/03/22/wbdnqsPIQ38KvDR.png"><meta property="og:type" content="article"><meta property="og:title" content="前端常用代码块"><meta property="og:url" content="https://www.laputcat.top/posts/5066d279.html"><meta property="og:site_name" content="爱笑的猫"><meta property="og:description" content="前端常用代码块或JS             适配基础知识 1.什么是rem  CSS3新增的一个相对单位rem（root em,根em）.rem是相对于根节点（或者是html节点）.  如果根节点设置了font-size:10px;那么font-size:1.2rem;字体大小等于12px  2.什么是dpr  dpr就是设备物理像素与逻辑像素(css像素)的比例."><meta property="og:image" content="https://i.loli.net/2020/03/22/wbdnqsPIQ38KvDR.png"><meta property="article:published_time" content="2019-12-04T02:52:37.000Z"><meta property="article:modified_time" content="2019-12-04T02:52:37.000Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://www.laputcat.top/posts/5066d279.html"><link rel="prev" title="Xampp汇总" href="https://www.laputcat.top/posts/2da0cc6f.html"><link rel="next" title="centos7 宝塔[LNMP] 访问swoole服务问题" href="https://www.laputcat.top/posts/593ef122.html"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-3688723022152326',
  enable_page_level_ads: 'true'
});</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-156528253-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://www.laputcat.top/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: 爱笑的猫","link":"链接: ","source":"来源: 爱笑的猫","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"top-right"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: false,
  highlightShrink: 'false',
  isFontAwesomeV5: true,
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="爱笑的猫" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="http://image.laputcat.top/blog/06818ca4361a28447cffdd2daaed2799.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">32</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">22</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">20</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-fw fa-battery-three-quarters"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#适配基础知识"><span class="toc-number">1.</span> <span class="toc-text">适配基础知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#淘宝方案解决以下问题"><span class="toc-number">2.</span> <span class="toc-text">淘宝方案解决以下问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#H5淘宝适配方案"><span class="toc-number">3.</span> <span class="toc-text">H5淘宝适配方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#重置CSS默认样式"><span class="toc-number">4.</span> <span class="toc-text">重置CSS默认样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#重置border默认样式"><span class="toc-number">5.</span> <span class="toc-text">重置border默认样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常用JS"><span class="toc-number">6.</span> <span class="toc-text">常用JS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#函数节流和函数防抖"><span class="toc-number">6.1.</span> <span class="toc-text">函数节流和函数防抖</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#函数节流"><span class="toc-number">6.2.</span> <span class="toc-text">函数节流</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#函数抖动"><span class="toc-number">6.3.</span> <span class="toc-text">函数抖动</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#函数防抖"><span class="toc-number">6.4.</span> <span class="toc-text">函数防抖</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绑定监听"><span class="toc-number">7.</span> <span class="toc-text">绑定监听</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IE与标准浏览器之间的样式-hack"><span class="toc-number">8.</span> <span class="toc-text">IE与标准浏览器之间的样式 hack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#清除浮动"><span class="toc-number">9.</span> <span class="toc-text">清除浮动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改chrome记住密码后自动填充表单的黄色背景"><span class="toc-number">10.</span> <span class="toc-text">修改chrome记住密码后自动填充表单的黄色背景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#将浮点数点左边的数每三位添加一个逗号，如12000000-11转化为『12-000-000-11"><span class="toc-number">11.</span> <span class="toc-text">将浮点数点左边的数每三位添加一个逗号，如12000000.11转化为『12,000,000.11</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#实现数组的随机排序"><span class="toc-number">12.</span> <span class="toc-text">实现数组的随机排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字符串截断"><span class="toc-number">13.</span> <span class="toc-text">字符串截断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字符串-trim–用于去除字符串两端的空白字符（直到遇到第一个非空白字符串为止它会清除包括换行符、空格、制表符等常见的空白字符。）"><span class="toc-number">14.</span> <span class="toc-text">字符串 trim–用于去除字符串两端的空白字符（直到遇到第一个非空白字符串为止它会清除包括换行符、空格、制表符等常见的空白字符。）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#表单验证改进系列"><span class="toc-number">15.</span> <span class="toc-text">表单验证改进系列</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#表单传统方式"><span class="toc-number">15.1.</span> <span class="toc-text">表单传统方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#策略设计模式"><span class="toc-number">15.2.</span> <span class="toc-text">策略设计模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Proxy代理模式"><span class="toc-number">15.3.</span> <span class="toc-text">Proxy代理模式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取滚动条距离顶部的距离"><span class="toc-number">16.</span> <span class="toc-text">获取滚动条距离顶部的距离</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取当前可视范围的高度"><span class="toc-number">17.</span> <span class="toc-text">获取当前可视范围的高度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取文档完整的高度，包括超出屏幕可以滚动显示的部分"><span class="toc-number">18.</span> <span class="toc-text">获取文档完整的高度，包括超出屏幕可以滚动显示的部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#移动端浮层滚动的同时阻止背后-document的整个滚动-重点使用频率高，很高"><span class="toc-number">19.</span> <span class="toc-text">移动端浮层滚动的同时阻止背后 document的整个滚动(重点使用频率高，很高)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义滚动条相关的七个伪元素"><span class="toc-number">20.</span> <span class="toc-text">自定义滚动条相关的七个伪元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16进制颜色代码生成"><span class="toc-number">21.</span> <span class="toc-text">16进制颜色代码生成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#驼峰命名转下划线"><span class="toc-number">22.</span> <span class="toc-text">驼峰命名转下划线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#日期格式化"><span class="toc-number">23.</span> <span class="toc-text">日期格式化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数字四舍五入"><span class="toc-number">24.</span> <span class="toc-text">数字四舍五入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器原生-Base64编码和解码方法"><span class="toc-number">25.</span> <span class="toc-text">浏览器原生 Base64编码和解码方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用委托冒泡，检测ul下被点击的li标签"><span class="toc-number">26.</span> <span class="toc-text">利用委托冒泡，检测ul下被点击的li标签</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#直接把函数赋值给变量"><span class="toc-number">27.</span> <span class="toc-text">直接把函数赋值给变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#遍历对象"><span class="toc-number">28.</span> <span class="toc-text">遍历对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hasOwnProperty-NaN"><span class="toc-number">29.</span> <span class="toc-text">hasOwnProperty</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#创建数组"><span class="toc-number">30.</span> <span class="toc-text">创建数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#检测对象的类型"><span class="toc-number">31.</span> <span class="toc-text">检测对象的类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#instanceof"><span class="toc-number">32.</span> <span class="toc-text">instanceof</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#手工清空定时器"><span class="toc-number">33.</span> <span class="toc-text">手工清空定时器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#优化选择器"><span class="toc-number">34.</span> <span class="toc-text">优化选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用事件委派"><span class="toc-number">35.</span> <span class="toc-text">使用事件委派</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#判定-IE7"><span class="toc-number">36.</span> <span class="toc-text">判定 IE7-</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#处理大量的数据"><span class="toc-number">37.</span> <span class="toc-text">处理大量的数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字符输出"><span class="toc-number">38.</span> <span class="toc-text">字符输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS中层叠上下文顺序"><span class="toc-number">39.</span> <span class="toc-text">CSS中层叠上下文顺序</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#由上到下，层次依次递减"><span class="toc-number">39.1.</span> <span class="toc-text">由上到下，层次依次递减</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#异常上报"><span class="toc-number">40.</span> <span class="toc-text">异常上报</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#深度判等"><span class="toc-number">41.</span> <span class="toc-text">深度判等</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#深度覆盖"><span class="toc-number">42.</span> <span class="toc-text">深度覆盖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#监控网页的崩溃"><span class="toc-number">43.</span> <span class="toc-text">监控网页的崩溃</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解决堆栈"><span class="toc-number">44.</span> <span class="toc-text">解决堆栈</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#堆栈溢出一般是由什么原因导致？"><span class="toc-number">44.1.</span> <span class="toc-text">堆栈溢出一般是由什么原因导致？</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/%EF%BC%88%E9%99%A4%E9%9D%9E%E7%89%B9%E5%AE%9A%E9%9C%80%E8%A6%81%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%B8%8D%E5%AF%AB%EF%BC%89)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">爱笑的猫</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-fw fa-battery-three-quarters"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">前端常用代码块</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-12-04 10:52:37"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-12-04</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2019-12-04 10:52:37"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-12-04</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/codeBlock/">codeBlock</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon far fa-file-word" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">8.6k</span><span class="post-meta__separator">|</span><i class="post-meta__icon far fa-clock" aria-hidden="true"></i><span>阅读时长: 37 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote class="blockquote-center"></blockquote>
<div class="note success">
            <p>前端常用代码块或JS</p>
          </div>

<h4 id="适配基础知识"><a href="#适配基础知识" class="headerlink" title="适配基础知识"></a>适配基础知识</h4><ul>
<li><p>1.什么是rem<br>  CSS3新增的一个相对单位rem（root em,根em）.rem是相对于根节点（或者是html节点）.<br>  如果根节点设置了font-size:10px;那么font-size:1.2rem;字体大小等于12px</p>
</li>
<li><p>2.什么是dpr<br>  dpr就是设备物理像素与逻辑像素(css像素)的比例.<br>  设备物理像素是固定的,比如macbook pro 13.3寸是显示屏分辨率是2560 x 1600,<br>  物理像素:2560就是当前设备的物理像素<br>  逻辑像素:浏览器全屏幕宽只有1280<br>  dpr所表示的就是：1280的浏览器被扩展成2560像素宽度,2个物理像素对应一个逻辑像素.</p>
<p>  再比如在开发中,一张设计好的宽度为100px,高度为50px的图片,再dpr值为2的设备中,宽度设置为100px的话,<br>  他实际会被扩展到200像素宽度,只有设为50的时候才会正常显示.</p>
</li>
<li><p>3.获取DPR<br>  浏览器控制台中输入:window.devicePixelRatio</p>
</li>
<li><p>4.说明<br>  针对不同手机屏幕尺寸和dpr动态的改变根节点html的font-size大小(基准值)。<br>  rem = document.documentElement.clientWidth * dpr / 10<br>  说明：<br>  乘以dpr，是因为页面有可能为了实现1px border页面会缩放(scale) 1/dpr 倍(如果没有，dpr=1),。<br>  除以10，是为了取整，方便计算(理论上可以是任何值)<br>  所以就像下面这样，html的font-size可能会：<br>  iphone3gs: 320px / 10 = 32px<br>  iphone4/5: 320px * 2 / 10 = 64px<br>  iphone6: 375px * 2 / 10 = 75px</p>
</li>
</ul>
<h4 id="淘宝方案解决以下问题"><a href="#淘宝方案解决以下问题" class="headerlink" title="淘宝方案解决以下问题"></a>淘宝方案解决以下问题</h4><ul>
<li>border: 1px问题</li>
<li>图片高清问题</li>
<li>屏幕适配布局问题</li>
</ul>
<h4 id="H5淘宝适配方案"><a href="#H5淘宝适配方案" class="headerlink" title="H5淘宝适配方案"></a>H5淘宝适配方案</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">N, M</span>) </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">L</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> a = I.getBoundingClientRect().width;</span><br><span class="line">		a / F &gt; <span class="number">540</span> &amp;&amp; (a = <span class="number">540</span> * F);</span><br><span class="line">		<span class="keyword">var</span> d = a / <span class="number">10</span>;</span><br><span class="line">		I.style.fontSize = d + <span class="string">"px"</span>, D.rem = N.rem = d</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> K, J = N.document,</span><br><span class="line">		I = J.documentElement,</span><br><span class="line">		H = J.querySelector(<span class="string">'meta[name="viewport"]'</span>),</span><br><span class="line">		G = J.querySelector(<span class="string">'meta[name="flexible"]'</span>),</span><br><span class="line">		F = <span class="number">0</span>,</span><br><span class="line">		E = <span class="number">0</span>,</span><br><span class="line">		D = M.flexible || (M.flexible = &#123;&#125;);</span><br><span class="line">	<span class="keyword">if</span> (H) &#123;</span><br><span class="line">		<span class="built_in">console</span>.warn(<span class="string">"将根据已有的meta标签来设置缩放比例"</span>);</span><br><span class="line">		<span class="keyword">var</span> C = H.getAttribute(<span class="string">"content"</span>).match(<span class="regexp">/initial\-scale=([\d\.]+)/</span>);</span><br><span class="line">		C &amp;&amp; (E = <span class="built_in">parseFloat</span>(C[<span class="number">1</span>]), F = <span class="built_in">parseInt</span>(<span class="number">1</span> / E))</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (G) &#123;</span><br><span class="line">			<span class="keyword">var</span> B = G.getAttribute(<span class="string">"content"</span>);</span><br><span class="line">			<span class="keyword">if</span> (B) &#123;</span><br><span class="line">				<span class="keyword">var</span> A = B.match(<span class="regexp">/initial\-dpr=([\d\.]+)/</span>),</span><br><span class="line">					z = B.match(<span class="regexp">/maximum\-dpr=([\d\.]+)/</span>);</span><br><span class="line">				A &amp;&amp; (F = <span class="built_in">parseFloat</span>(A[<span class="number">1</span>]), E = <span class="built_in">parseFloat</span>((<span class="number">1</span> / F).toFixed(<span class="number">2</span>))), z &amp;&amp; (F = <span class="built_in">parseFloat</span>(z[<span class="number">1</span>]), E = <span class="built_in">parseFloat</span>((<span class="number">1</span> / F).toFixed(<span class="number">2</span>)))</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!F &amp;&amp; !E) &#123;</span><br><span class="line">		<span class="keyword">var</span> y = N.navigator.userAgent,</span><br><span class="line">			x = ( !! y.match(<span class="regexp">/android/gi</span>), !! y.match(<span class="regexp">/iphone/gi</span>)),</span><br><span class="line">			w = x &amp;&amp; !! y.match(<span class="regexp">/OS 9_3/</span>),</span><br><span class="line">			v = N.devicePixelRatio;</span><br><span class="line">		F = x &amp;&amp; !w ? v &gt;= <span class="number">3</span> &amp;&amp; (!F || F &gt;= <span class="number">3</span>) ? <span class="number">3</span> : v &gt;= <span class="number">2</span> &amp;&amp; (!F || F &gt;= <span class="number">2</span>) ? <span class="number">2</span> : <span class="number">1</span> : <span class="number">1</span>, E = <span class="number">1</span> / F</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (I.setAttribute(<span class="string">"data-dpr"</span>, F), !H) &#123;</span><br><span class="line">		<span class="keyword">if</span> (H = J.createElement(<span class="string">"meta"</span>), H.setAttribute(<span class="string">"name"</span>, <span class="string">"viewport"</span>), H.setAttribute(<span class="string">"content"</span>, <span class="string">"initial-scale="</span> + E + <span class="string">", maximum-scale="</span> + E + <span class="string">", minimum-scale="</span> + E + <span class="string">", user-scalable=no"</span>), I.firstElementChild) &#123;</span><br><span class="line">			I.firstElementChild.appendChild(H)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">var</span> u = J.createElement(<span class="string">"div"</span>);</span><br><span class="line">			u.appendChild(H), J.write(u.innerHTML)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	N.addEventListener(<span class="string">"resize"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		clearTimeout(K), K = setTimeout(L, <span class="number">300</span>)</span><br><span class="line">	&#125;, !<span class="number">1</span>), N.addEventListener(<span class="string">"pageshow"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">b</span>) </span>&#123;</span><br><span class="line">		b.persisted &amp;&amp; (clearTimeout(K), K = setTimeout(L, <span class="number">300</span>))</span><br><span class="line">	&#125;, !<span class="number">1</span>), <span class="string">"complete"</span> === J.readyState ? J.body.style.fontSize = <span class="number">12</span> * F + <span class="string">"px"</span> : J.addEventListener(<span class="string">"DOMContentLoaded"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		J.body.style.fontSize = <span class="number">12</span> * F + <span class="string">"px"</span></span><br><span class="line">	&#125;, !<span class="number">1</span>), L(), D.dpr = N.dpr = F, D.refreshRem = L, D.rem2px = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> c = <span class="built_in">parseFloat</span>(d) * <span class="keyword">this</span>.rem;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"string"</span> == <span class="keyword">typeof</span> d &amp;&amp; d.match(<span class="regexp">/rem$/</span>) &amp;&amp; (c += <span class="string">"px"</span>), c</span><br><span class="line">	&#125;, D.px2rem = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> c = <span class="built_in">parseFloat</span>(d) / <span class="keyword">this</span>.rem;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"string"</span> == <span class="keyword">typeof</span> d &amp;&amp; d.match(<span class="regexp">/px$/</span>) &amp;&amp; (c += <span class="string">"rem"</span>), c</span><br><span class="line">	&#125;</span><br><span class="line">&#125;(<span class="built_in">window</span>, <span class="built_in">window</span>.lib || (<span class="built_in">window</span>.lib = &#123;&#125;));</span><br></pre></td></tr></table></figure>
<h4 id="重置CSS默认样式"><a href="#重置CSS默认样式" class="headerlink" title="重置CSS默认样式"></a>重置CSS默认样式</h4><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@charset</span> <span class="string">"utf-8"</span>;<span class="selector-tag">html</span>&#123;<span class="attribute">background-color</span>:<span class="number">#fff</span>;<span class="attribute">color</span>:<span class="number">#000</span>;<span class="attribute">font-size</span>:<span class="number">12px</span>&#125;</span><br><span class="line">body,ul,ol,dl,dd,h1,h2,h3,h4,h5,h6,figure,form,fieldset,legend,input,textarea,button,p,blockquote,th,td,pre,xmp&#123;margin:<span class="number">0</span>;<span class="attribute">padding</span>:<span class="number">0</span>&#125;</span><br><span class="line">body,input,textarea,button,select,pre,xmp,tt,code,kbd,samp&#123;line-height:<span class="number">1.5</span>;<span class="attribute">font-family</span>:tahoma,arial,<span class="string">"Hiragino Sans GB"</span>,simsun,sans-serif&#125;</span><br><span class="line">h1,h2,h3,h4,h5,h6,small,big,input,textarea,button,select&#123;font-size:<span class="number">100%</span>&#125;</span><br><span class="line">h1,h2,h3,h4,h5,h6&#123;font-family:tahoma,arial,<span class="string">"Hiragino Sans GB"</span>,<span class="string">"微软雅黑"</span>,simsun,sans-serif&#125;</span><br><span class="line">h1,h2,h3,h4,h5,h6,b,strong&#123;font-weight:normal&#125;</span><br><span class="line">address,cite,dfn,em,i,optgroup,var&#123;font-style:normal&#125;</span><br><span class="line">table&#123;border-collapse:collapse;<span class="attribute">border-spacing</span>:<span class="number">0</span>;<span class="attribute">text-align</span><span class="selector-pseudo">:left</span>&#125;</span><br><span class="line"><span class="selector-tag">caption</span>,<span class="selector-tag">th</span>&#123;<span class="attribute">text-align</span>:inherit&#125;</span><br><span class="line">ul,ol,menu&#123;list-style:none&#125;</span><br><span class="line">fieldset,img&#123;border:<span class="number">0</span>&#125;</span><br><span class="line">img,object,input,textarea,button,select&#123;vertical-align:middle&#125;</span><br><span class="line">article,aside,footer,header,section,nav,figure,figcaption,hgroup,details,menu&#123;display:block&#125;</span><br><span class="line">audio,canvas,video&#123;display:inline-block;*<span class="attribute">display</span>:inline;*zoom:<span class="number">1</span>&#125;</span><br><span class="line">blockquote:before,blockquote:after,q:before,q:after&#123;content:<span class="string">"\0020"</span>&#125;</span><br><span class="line">textarea&#123;overflow:auto;<span class="attribute">resize</span>:vertical&#125;</span><br><span class="line">input,textarea,button,select,a&#123;outline:<span class="number">0</span> none;<span class="attribute">border</span>: none;&#125;</span><br><span class="line"><span class="selector-tag">button</span>::-moz-focus-inner,input::-moz-focus-inner&#123;padding:<span class="number">0</span>;<span class="attribute">border</span>:<span class="number">0</span>&#125;</span><br><span class="line">mark&#123;background-color:transparent&#125;</span><br><span class="line">a,ins,s,u,del&#123;text-decoration:none&#125;</span><br><span class="line">sup,sub&#123;vertical-align:baseline&#125;</span><br><span class="line">html &#123;overflow-x: hidden;<span class="attribute">height</span>: <span class="number">100%</span>;<span class="attribute">font-size</span>: <span class="number">50px</span>;-webkit-tap-highlight-<span class="attribute">color</span>: transparent;&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">font-family</span>: Arial, <span class="string">"Microsoft Yahei"</span>, <span class="string">"Helvetica Neue"</span>, Helvetica, sans-serif;<span class="attribute">color</span>: <span class="number">#333</span>;<span class="attribute">font-size</span>: .<span class="number">28em</span>;<span class="attribute">line-height</span>: <span class="number">1</span>;-webkit-text-size-adjust: none;&#125;</span><br><span class="line"><span class="selector-tag">hr</span> &#123;<span class="attribute">height</span>: .<span class="number">02rem</span>;<span class="attribute">margin</span>: .<span class="number">1rem</span> <span class="number">0</span>;<span class="attribute">border</span>: medium none;<span class="attribute">border-top</span>: .<span class="number">02rem</span> solid <span class="number">#cacaca</span>;&#125;</span><br><span class="line"><span class="selector-tag">a</span> &#123;<span class="attribute">color</span>: <span class="number">#25a4bb</span>;<span class="attribute">text-decoration</span>: none;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="重置border默认样式"><a href="#重置border默认样式" class="headerlink" title="重置border默认样式"></a>重置border默认样式</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@charset</span> <span class="string">"utf-8"</span>;</span><br><span class="line"><span class="selector-class">.border</span>,</span><br><span class="line"><span class="selector-class">.border-top</span>,</span><br><span class="line"><span class="selector-class">.border-right</span>,</span><br><span class="line"><span class="selector-class">.border-bottom</span>,</span><br><span class="line"><span class="selector-class">.border-left</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-top</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-right</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-bottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-left</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">"\0020"</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* border</span></span><br><span class="line"><span class="comment"> * 因，边框是由伪元素区域遮盖在父级</span></span><br><span class="line"><span class="comment"> * 故，子级若有交互，需要对子级设置</span></span><br><span class="line"><span class="comment"> * 定位 及 z轴</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.border</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eaeaea</span>;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-top</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-bottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-right</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-left</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-top</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#eaeaea</span>;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-right</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="number">#eaeaea</span>;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">100%</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-bottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#eaeaea</span>;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">0</span> <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-left</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">1px</span> solid <span class="number">#eaeaea</span>;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-top</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-right</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topright</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-bottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.border-left</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.border-topleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line"><span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max--moz-device-pixel-ratio:</span> <span class="number">1.49</span>), (<span class="attribute">-webkit-max-device-pixel-ratio:</span> <span class="number">1.49</span>), (<span class="attribute">max-device-pixel-ratio:</span> <span class="number">1.49</span>), (<span class="attribute">max-resolution:</span> <span class="number">143dpi</span>), (<span class="attribute">max-resolution:</span> <span class="number">1.49dppx</span>) &#123;</span><br><span class="line">    <span class="comment">/* 默认值，无需重置 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">min--moz-device-pixel-ratio:</span> <span class="number">1.5</span>) <span class="keyword">and</span> (<span class="attribute">max--moz-device-pixel-ratio:</span> <span class="number">2.49</span>), (<span class="attribute">-webkit-min-device-pixel-ratio:</span> <span class="number">1.5</span>) <span class="keyword">and</span> (<span class="attribute">-webkit-max-device-pixel-ratio:</span> <span class="number">2.49</span>), (<span class="attribute">min-device-pixel-ratio:</span> <span class="number">1.5</span>) <span class="keyword">and</span> (<span class="attribute">max-device-pixel-ratio:</span> <span class="number">2.49</span>), (<span class="attribute">min-resolution:</span> <span class="number">144dpi</span>) <span class="keyword">and</span> (<span class="attribute">max-resolution:</span> <span class="number">239dpi</span>), (<span class="attribute">min-resolution:</span> <span class="number">1.5dppx</span>) <span class="keyword">and</span> (<span class="attribute">max-resolution:</span> <span class="number">2.49dppx</span>) &#123;</span><br><span class="line">    <span class="selector-class">.border</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">200%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200%</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(.<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.border-top</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-bottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-topleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-topright</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scaleY</span>(.<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.border-right</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-left</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-topleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-topright</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scaleX</span>(.<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">min--moz-device-pixel-ratio:</span> <span class="number">2.5</span>), (<span class="attribute">-webkit-min-device-pixel-ratio:</span> <span class="number">2.5</span>), (<span class="attribute">min-device-pixel-ratio:</span> <span class="number">2.5</span>), (<span class="attribute">min-resolution:</span> <span class="number">240dpi</span>), (<span class="attribute">min-resolution:</span> <span class="number">2.5dppx</span>) &#123;</span><br><span class="line">    <span class="selector-class">.border</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">300%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">300%</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(.<span class="number">33333</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.border-top</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-bottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-topbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-topleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-topright</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scaleY</span>(.<span class="number">33333</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.border-right</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-left</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-rightleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-topleft</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-rightbottom</span><span class="selector-pseudo">::before</span>,</span><br><span class="line">    <span class="selector-class">.border-topright</span><span class="selector-pseudo">::after</span>,</span><br><span class="line">    <span class="selector-class">.border-bottomleft</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scaleX</span>(.<span class="number">33333</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="常用JS"><a href="#常用JS" class="headerlink" title="常用JS"></a>常用JS</h4><h5 id="函数节流和函数防抖"><a href="#函数节流和函数防抖" class="headerlink" title="函数节流和函数防抖"></a>函数节流和函数防抖</h5><ul>
<li>做的事情（把js代码的执行次数控制在合理的范围。既能节省浏览器CPU资源，又能让页面浏览更加顺畅，不会因为js的执行而发生卡顿。）<h5 id="函数节流"><a href="#函数节流" class="headerlink" title="函数节流"></a>函数节流</h5></li>
<li>指一定时间内js方法只跑一次。比如人的眨眼睛，就是一定时间内眨一次。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> canRun = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"throttle"</span>).onscroll = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!canRun)&#123;</span><br><span class="line">        <span class="comment">// 判断是否已空闲，如果在执行中，则直接return</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    canRun = <span class="literal">false</span>;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"函数节流"</span>);</span><br><span class="line">        canRun = <span class="literal">true</span>;</span><br><span class="line">    &#125;, <span class="number">300</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 解析要点</span></span><br><span class="line">函数节流的要点是，声明一个变量当标志位，记录当前代码是否在执行。</span><br><span class="line"> 如果空闲，则可以正常触发方法执行。</span><br><span class="line"> 如果代码正在执行，则取消这次方法执行，直接<span class="keyword">return</span>。</span><br><span class="line"></span><br><span class="line"> 这个方法的作用是监听ID为throttle元素的滚动事件。</span><br><span class="line"> 当canRun为<span class="literal">true</span>，则代表现在的滚动处理事件是空闲的，可以使用。</span><br><span class="line"> 通过关卡<span class="keyword">if</span>(!canRun)，等于就拿到了通行证。然后下一步的操作就是立马将关卡关上canRun=<span class="literal">false</span>。这样，其他请求执行滚动事件的方法，就被挡回去了。</span><br><span class="line"> 接着用setTimeout规定最小的时间间隔<span class="number">300</span>，接着再执行setTimeout方法体里面的内容。</span><br><span class="line"> 最后，等setTimeout里面的方法都执行完毕，才释放关卡canRun=<span class="literal">true</span>，允许下一个访问者进来。</span><br></pre></td></tr></table></figure>


<h5 id="函数抖动"><a href="#函数抖动" class="headerlink" title="函数抖动"></a>函数抖动</h5><ul>
<li><p>指频繁触发的情况下，只有足够的空闲时间，才执行代码一次。比如生活中的坐公交，就是一定时间内，如果有人陆续刷卡上车，司机就不会开车。只有别人没刷卡了，司机才开车。</p>
</li>
<li><p>最常见的就是用户注册时候的手机号码验证和邮箱验证了。只有等用户输入完毕后，前端才需要检查格式是否正确，如果不正确，再弹出提示语</p>
<h5 id="函数防抖"><a href="#函数防抖" class="headerlink" title="函数防抖"></a>函数防抖</h5></li>
<li><p>函数防抖的实现重点，就是巧用setTimeout做缓存池，而且可以轻易地清除待执行的代码。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> timer = <span class="literal">false</span>;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"debounce"</span>).onscroll = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">clearTimeout(timer); <span class="comment">// 清除未执行的代码，重置回初始化状态</span></span><br><span class="line"></span><br><span class="line">timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"函数防抖"</span>);</span><br><span class="line">    &#125;, <span class="number">300</span>);</span><br><span class="line">&#125;;  </span><br><span class="line"><span class="comment">// 去抖</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, delay</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeout;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"清除"</span>,timeout,e.target.value)</span><br><span class="line">        clearTimeout(timeout);</span><br><span class="line">        <span class="keyword">var</span> context = <span class="keyword">this</span>, args = <span class="built_in">arguments</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"新的"</span>,timeout, e.target.value)</span><br><span class="line">        timeout = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"----"</span>)</span><br><span class="line">            func.apply(context, args);</span><br><span class="line">        &#125;,delay)</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> validate = debounce(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"change"</span>, e.target.value, <span class="keyword">new</span> <span class="built_in">Date</span><span class="number">-0</span>)</span><br><span class="line">&#125;, <span class="number">380</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="绑定监听"><a href="#绑定监听" class="headerlink" title="绑定监听"></a>绑定监听</h4><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">document.query<span class="constructor">Selector(<span class="string">"input"</span>)</span>.add<span class="constructor">EventListener('<span class="params">input</span>', <span class="params">validate</span>)</span>;</span><br></pre></td></tr></table></figure>
<h4 id="IE与标准浏览器之间的样式-hack"><a href="#IE与标准浏览器之间的样式-hack" class="headerlink" title="IE与标准浏览器之间的样式 hack"></a>IE与标准浏览器之间的样式 hack</h4><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.bb</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>:red;<span class="comment">/*所有识别*/</span></span><br><span class="line">    <span class="attribute">background-color</span>:<span class="number">#00deff</span>\<span class="number">9</span>; <span class="comment">/*IE6、7、8识别*/</span></span><br><span class="line">    +<span class="attribute">background-color</span>:<span class="number">#a200ff</span>;<span class="comment">/*IE6、7识别*/</span></span><br><span class="line">    _background-<span class="attribute">color</span>:<span class="number">#1e0bd1</span>;<span class="comment">/*IE6识别*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="清除浮动"><a href="#清除浮动" class="headerlink" title="清除浮动"></a>清除浮动</h4><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">"020"</span>; </span><br><span class="line">    <span class="attribute">display</span>: block; </span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>; </span><br><span class="line">    <span class="attribute">clear</span>: both; </span><br><span class="line">    <span class="attribute">visibility</span>: hidden;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clear</span>&#123;</span><br><span class="line">    *zoom:<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解析原理：</p>
<ul>
<li>display:block 使生成的元素以块级元素显示,占满剩余空间;</li>
<li>height:0 避免生成内容破坏原有布局的高度。</li>
<li>visibility:hidden 使生成的内容不可见，并允许可能被生成内容盖住的内容可以进行点击和交互;</li>
<li>通过 content:”.”生成内容作为最后一个元素，至于content里面是点还是其他都是可以的， 例如oocss里面就有经典的 content:”.”,有些版本可能content 里面内容为空,不推荐这样做, firefox直到7.0 content:”” 仍然会产生额外的空隙</li>
<li>zoom：1 触发IE hasLayout。</li>
</ul>
<h4 id="修改chrome记住密码后自动填充表单的黄色背景"><a href="#修改chrome记住密码后自动填充表单的黄色背景" class="headerlink" title="修改chrome记住密码后自动填充表单的黄色背景"></a>修改chrome记住密码后自动填充表单的黄色背景</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:-webkit-autofill</span>, <span class="selector-tag">textarea</span><span class="selector-pseudo">:-webkit-autofill</span>, <span class="selector-tag">select</span><span class="selector-pseudo">:-webkit-autofill</span> &#123;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">250</span>, <span class="number">255</span>, <span class="number">189</span>); <span class="comment">/* #FAFFBD; */</span></span><br><span class="line"><span class="attribute">background-image</span>: none;</span><br><span class="line"><span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="将浮点数点左边的数每三位添加一个逗号，如12000000-11转化为『12-000-000-11"><a href="#将浮点数点左边的数每三位添加一个逗号，如12000000-11转化为『12-000-000-11" class="headerlink" title="将浮点数点左边的数每三位添加一个逗号，如12000000.11转化为『12,000,000.11"></a>将浮点数点左边的数每三位添加一个逗号，如12000000.11转化为『12,000,000.11</h4><figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">commafy</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num &amp;&amp; num</span><br><span class="line">    .toString()</span><br><span class="line">    .replace(<span class="regexp">/(\d)(?=(\d&#123;3&#125;)+\.)/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$<span class="number">1</span>, $<span class="number">2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $<span class="number">2</span> + <span class="string">','</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="实现数组的随机排序"><a href="#实现数组的随机排序" class="headerlink" title="实现数组的随机排序"></a>实现数组的随机排序</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">var arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</span><br><span class="line">arr.sort(function()&#123;</span><br><span class="line">    <span class="keyword">return</span> Math.random() - <span class="number">0.5</span>;</span><br><span class="line">&#125;)</span><br><span class="line">console.log(arr);</span><br></pre></td></tr></table></figure>
<h4 id="字符串截断"><a href="#字符串截断" class="headerlink" title="字符串截断"></a>字符串截断</h4><figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* target: 需要截断字符串</span></span><br><span class="line"><span class="comment">* length: 希望字符串被阶段后的长度</span></span><br><span class="line"><span class="comment">* truncation: 可选，代替所截断多余字符的字符</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">function truncate(target,<span class="built_in">length</span>,truncation)&#123;</span><br><span class="line">    <span class="built_in">length</span>=<span class="built_in">length</span> || <span class="number">30</span>;</span><br><span class="line">    truncation=truncation===<span class="type">void</span>(<span class="number">0</span>)?'...':truncation;</span><br><span class="line">    <span class="keyword">return</span> t.<span class="built_in">length</span>&gt;<span class="built_in">length</span> ? t.slice(<span class="number">0</span>,<span class="built_in">length</span>-truncation.<span class="built_in">length</span>)+truncation : String(t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="字符串-trim–用于去除字符串两端的空白字符（直到遇到第一个非空白字符串为止它会清除包括换行符、空格、制表符等常见的空白字符。）"><a href="#字符串-trim–用于去除字符串两端的空白字符（直到遇到第一个非空白字符串为止它会清除包括换行符、空格、制表符等常见的空白字符。）" class="headerlink" title="字符串 trim–用于去除字符串两端的空白字符（直到遇到第一个非空白字符串为止它会清除包括换行符、空格、制表符等常见的空白字符。）"></a>字符串 trim–用于去除字符串两端的空白字符（直到遇到第一个非空白字符串为止它会清除包括换行符、空格、制表符等常见的空白字符。）</h4><figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line">简单好记版本</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trim</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/^\s\s*/</span>, <span class="string">''</span>).replace(<span class="regexp">/\s\s*$/</span>, <span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 速度超快版本(其实还有比这个更快的)</span></span><br><span class="line"><span class="comment">// 前面的空格用正则，后面的用字符串原生方法</span></span><br><span class="line">function <span class="built_in">trim</span>(<span class="built_in">str</span>) &#123;</span><br><span class="line">    <span class="built_in">str</span>=<span class="built_in">str</span>.replace(/^\s+/, <span class="string">''</span>);</span><br><span class="line">    var len=<span class="built_in">str</span>.length<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(var i=len; i&gt;=<span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">if</span>(/\S/.test(<span class="built_in">str</span>.charAt(i))) &#123;</span><br><span class="line">        <span class="built_in">str</span>=<span class="built_in">str</span>.substring(<span class="number">0</span>, i+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="表单验证改进系列"><a href="#表单验证改进系列" class="headerlink" title="表单验证改进系列"></a>表单验证改进系列</h4><p>三种表单验证模式–传统模式、策略设计模式、ES6的Proxy代理模式</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">let html=`&lt;<span class="keyword">form</span> action=<span class="string">"a.php"</span> id=<span class="string">"registerForm"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">label</span> <span class="keyword">for</span>=<span class="string">"user"</span>&gt;请输入用户名:&lt;/<span class="keyword">label</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"text"</span> <span class="keyword">class</span>=<span class="string">"form-control"</span> id=<span class="string">"user"</span> name=<span class="string">"userName"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">label</span> <span class="keyword">for</span>=<span class="string">"pwd"</span>&gt;请输入密码:&lt;/<span class="keyword">label</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"password"</span> <span class="keyword">class</span>=<span class="string">"form-control"</span> id=<span class="string">"pwd"</span> name=<span class="string">"passWord"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">label</span> <span class="keyword">for</span>=<span class="string">"phone"</span>&gt;请输入手机号码:&lt;/<span class="keyword">label</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"tel"</span> <span class="keyword">class</span>=<span class="string">"form-control"</span> id=<span class="string">"phone"</span> name=<span class="string">"phoneNumber"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">label</span> <span class="keyword">for</span>=<span class="string">"email"</span>&gt;请输入邮箱:&lt;/<span class="keyword">label</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"text"</span> <span class="keyword">class</span>=<span class="string">"form-control"</span> id=<span class="string">"email"</span> name=<span class="string">"emailAddress"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"submit"</span> value='提交'&gt;</span><br><span class="line">&lt;/<span class="keyword">form</span>&gt;`</span><br></pre></td></tr></table></figure>
<h5 id="表单传统方式"><a href="#表单传统方式" class="headerlink" title="表单传统方式"></a>表单传统方式</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">let registerForm = document.querySelector(<span class="string">'#registerForm'</span>)</span><br><span class="line">registerForm.addEventListener(<span class="string">'submit'</span>, <span class="keyword">function</span>() &#123;</span><br><span class="line"><span class="keyword">if</span> (registerForm.userName.<span class="keyword">value</span> === <span class="string">''</span>) &#123;</span><br><span class="line">    alert(<span class="string">'用户名不能为空！'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (registerForm.userName.length &lt; <span class="number">6</span>) &#123;</span><br><span class="line">    alert(<span class="string">'用户名长度不能少于6位！'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (registerForm.<span class="keyword">passWord</span>.<span class="keyword">value</span> === <span class="string">''</span>) &#123;</span><br><span class="line">    alert(<span class="string">'密码不能为空！'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (registerForm.<span class="keyword">passWord</span>.<span class="keyword">value</span>.length &lt; <span class="number">6</span>) &#123;</span><br><span class="line">    alert(<span class="string">'密码长度不能少于6位！'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (registerForm.phoneNumber.<span class="keyword">value</span> === <span class="string">''</span>) &#123;</span><br><span class="line">    alert(<span class="string">'手机号码不能为空！'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!/^<span class="number">1</span>(<span class="number">3</span>|<span class="number">5</span>|<span class="number">7</span>|<span class="number">8</span>|<span class="number">9</span>)[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">9</span>&#125;$/.test(registerForm.phoneNumber.<span class="keyword">value</span>)) &#123;</span><br><span class="line">    alert(<span class="string">'手机号码格式不正确！'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (registerForm.emailAddress.<span class="keyword">value</span> === <span class="string">''</span>) &#123;</span><br><span class="line">    alert(<span class="string">'邮箱地址不能为空！'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!/^\w+([+-.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*</span><br><span class="line">    $/.test(registerForm.emailAddress.<span class="keyword">value</span>)) &#123;</span><br><span class="line">        alert(<span class="string">'邮箱地址格式不正确！'</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="keyword">false</span>)</span><br></pre></td></tr></table></figure>
<p>// 优缺点：代码易于理解，但复用性不好，较多的if…else 业务判断</p>
<h5 id="策略设计模式"><a href="#策略设计模式" class="headerlink" title="策略设计模式"></a>策略设计模式</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line"><span class="keyword">let</span> registerForm = <span class="built_in">document</span>.querySelector(<span class="string">'#registerForm'</span>)</span><br><span class="line"><span class="keyword">const</span> strategies = &#123;</span><br><span class="line">    isNonEmpty(value, errorMsg)&#123;</span><br><span class="line">        <span class="keyword">return</span> value === <span class="string">''</span> ? errorMsg : <span class="keyword">void</span> <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    minLength(value, length, errorMsg) &#123;</span><br><span class="line">        <span class="keyword">return</span> value.length &lt; length ? errorMsg : <span class="keyword">void</span> <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    isMoblie(value, errorMsg) &#123;</span><br><span class="line">        <span class="keyword">return</span> !<span class="regexp">/^1(3|5|7|8|9)[0-9]&#123;9&#125;$/</span>.test(value) ? errorMsg : <span class="keyword">void</span> <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    isEmail(value, errorMsg) &#123;</span><br><span class="line">        <span class="keyword">return</span> !<span class="regexp">/^\w+([+-.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/</span>.test(value) ? errorMsg : <span class="keyword">void</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Validator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.cache = [] <span class="comment">//保存校验规则</span></span><br><span class="line">    &#125;</span><br><span class="line">    add(dom, rules) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> rule <span class="keyword">of</span> rules) &#123;</span><br><span class="line">            <span class="keyword">let</span> strategyAry = rule.strategy.split(<span class="string">':'</span>) <span class="comment">//例如['minLength',6]</span></span><br><span class="line">            <span class="keyword">let</span> errorMsg = rule.errorMsg <span class="comment">//'用户名不能为空'</span></span><br><span class="line">            <span class="keyword">this</span>.cache.push(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> strategy = strategyAry.shift() <span class="comment">//用户挑选的strategy</span></span><br><span class="line">                strategyAry.unshift(dom.value) <span class="comment">//把input的value添加进参数列表</span></span><br><span class="line">                strategyAry.push(errorMsg) <span class="comment">//把errorMsg添加进参数列表，[dom.value,6,errorMsg]</span></span><br><span class="line">                <span class="keyword">return</span> strategies[strategy].apply(dom, strategyAry)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    start() &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> validatorFunc <span class="keyword">of</span> <span class="keyword">this</span>.cache) &#123;</span><br><span class="line">            <span class="keyword">let</span> errorMsg = validatorFunc()<span class="comment">//开始校验，并取得校验后的返回信息</span></span><br><span class="line">            <span class="keyword">if</span> (errorMsg) &#123;<span class="comment">//r如果有确切返回值，说明校验没有通过</span></span><br><span class="line">                <span class="keyword">return</span> errorMsg</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> validatorFunc = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> validator = <span class="keyword">new</span> Validator()</span><br><span class="line"></span><br><span class="line">validator.add(registerForm.userName, [&#123;</span><br><span class="line">    strategy: <span class="string">'isNonEmpty'</span>,</span><br><span class="line">    errorMsg: <span class="string">'用户名不能为空！'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">    strategy: <span class="string">'minLength:6'</span>,</span><br><span class="line">    errorMsg: <span class="string">'用户名长度不能小于6位！'</span></span><br><span class="line">&#125;])</span><br><span class="line"></span><br><span class="line">validator.add(registerForm.passWord, [&#123;</span><br><span class="line">    strategy: <span class="string">'isNonEmpty'</span>,</span><br><span class="line">    errorMsg: <span class="string">'密码不能为空！'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">    strategy: <span class="string">'minLength:6'</span>,</span><br><span class="line">    errorMsg: <span class="string">'密码长度不能小于6位！'</span></span><br><span class="line">&#125;])</span><br><span class="line"></span><br><span class="line">validator.add(registerForm.phoneNumber, [&#123;</span><br><span class="line">    strategy: <span class="string">'isNonEmpty'</span>,</span><br><span class="line">    errorMsg: <span class="string">'手机号码不能为空！'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">    strategy: <span class="string">'isMoblie'</span>,</span><br><span class="line">    errorMsg: <span class="string">'手机号码格式不正确！'</span></span><br><span class="line">&#125;])</span><br><span class="line"></span><br><span class="line">validator.add(registerForm.emailAddress, [&#123;</span><br><span class="line">    strategy: <span class="string">'isNonEmpty'</span>,</span><br><span class="line">    errorMsg: <span class="string">'邮箱地址不能为空！'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">    strategy: <span class="string">'isEmail'</span>,</span><br><span class="line">    errorMsg: <span class="string">'邮箱地址格式不正确！'</span></span><br><span class="line">&#125;])</span><br><span class="line"><span class="keyword">let</span> errorMsg = validator.start()</span><br><span class="line">    <span class="keyword">return</span> errorMsg</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">registerForm.addEventListener(<span class="string">'submit'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line"><span class="keyword">let</span> errorMsg = validatorFunc()</span><br><span class="line"><span class="keyword">if</span> (errorMsg) &#123;</span><br><span class="line">    <span class="comment">// 注意，这里写 `return false;` 或者 `retirn;` 都是没什么卵用的，</span></span><br><span class="line">    <span class="comment">// 阻止表单默认提交动作，必须使用 preventDefault</span></span><br><span class="line">        e.preventDefault()</span><br><span class="line">        alert(errorMsg)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>// 优缺点：利用组合、委托和多态等技术思想，易于扩展、复用性好，缺点就是代码量比第一种稍多</p>
<h5 id="Proxy代理模式"><a href="#Proxy代理模式" class="headerlink" title="Proxy代理模式"></a>Proxy代理模式</h5><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line"><span class="keyword">window</span>.onload = ()=&gt;&#123;</span><br><span class="line"><span class="keyword">let</span> validator = (target, validator, errorMsg)=&gt; &#123;</span><br><span class="line"><span class="keyword">return</span> new Proxy(target, &#123;</span><br><span class="line">    _validator: validator,</span><br><span class="line">    set(target,<span class="built_in"> key</span>, <span class="keyword">value</span>, proxy) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">value</span> === <span class="string">''</span>) &#123;</span><br><span class="line">        alert(`$&#123;errorMsg<span class="built_in">[key</span>]&#125;不能为空！`)</span><br><span class="line">        <span class="keyword">return</span> target<span class="built_in">[key</span>] =<span class="built_in"> false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> va = this._validator<span class="built_in">[key</span>]</span><br><span class="line">    <span class="keyword">if</span>(!!va(<span class="keyword">value</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> Reflect.set(target,<span class="built_in"> key</span>, <span class="keyword">value</span>, proxy)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(`$&#123;errorMsg<span class="built_in">[key</span>]&#125;格式不正确`)</span><br><span class="line">        <span class="keyword">return</span> target<span class="built_in">[key</span>] =<span class="built_in"> false</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const validators = &#123;</span><br><span class="line">name(<span class="keyword">value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">value</span>.length &gt; <span class="number">6</span></span><br><span class="line">&#125;,</span><br><span class="line">password(<span class="keyword">value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">value</span>.length &gt; <span class="number">6</span></span><br><span class="line">&#125;,</span><br><span class="line">mobile(<span class="keyword">value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> /^<span class="number">1</span>(<span class="number">3</span>|<span class="number">5</span>|<span class="number">7</span>|<span class="number">8</span>|<span class="number">9</span>)[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">9</span>&#125;$/.test(<span class="keyword">value</span>)</span><br><span class="line">&#125;,</span><br><span class="line">email(<span class="keyword">value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> /^[a-z<span class="number">0</span>-<span class="number">9</span>]+([.<span class="number">_</span>\\-]*[a-z<span class="number">0</span>-<span class="number">9</span>])*@([a-z<span class="number">0</span>-<span class="number">9</span>]+[-a-z<span class="number">0</span>-<span class="number">9</span>]*[a-z<span class="number">0</span>-<span class="number">9</span>]+.)&#123;<span class="number">1</span>,<span class="number">63</span>&#125;[a-z<span class="number">0</span>-<span class="number">9</span>]+$/.test(<span class="keyword">value</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const errorMsg = &#123;<span class="built_in"> name</span>: <span class="string">'用户名'</span>, password: <span class="string">'密码'</span>, mobile: <span class="string">'手机号码'</span>, email: <span class="string">'邮箱地址'</span> &#125;</span><br><span class="line">const vali = validator(&#123;&#125;, validators, errorMsg)</span><br><span class="line"><span class="keyword">let</span> registerForm =<span class="built_in"> document</span>.querySelector(<span class="string">'#registerForm'</span>)</span><br><span class="line">    registerForm.addEventListener(<span class="string">'submit'</span>, (e)=&gt;&#123;</span><br><span class="line">        <span class="keyword">let</span> validatorNext = <span class="keyword">function</span>* ()&#123;</span><br><span class="line">            yield vali<span class="built_in">.name</span> = registerForm.userName.<span class="keyword">value</span></span><br><span class="line">            yield vali.password = registerForm.passWord.<span class="keyword">value</span></span><br><span class="line">            yield vali.mobile = registerForm.phoneNumber.<span class="keyword">value</span></span><br><span class="line">            yield vali.email = registerForm.emailAddress.<span class="keyword">value</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> validator = validatorNext()</span><br><span class="line">        validator.<span class="keyword">next</span>()</span><br><span class="line">        <span class="keyword">let</span> s = vali<span class="built_in">.name</span> &amp;&amp; validator.<span class="keyword">next</span>() //上一步的校验通过才执行下一步</span><br><span class="line">        s = s ? vali.password &amp;&amp; validator.<span class="keyword">next</span>() : s</span><br><span class="line">        s = s ? vali.mobile &amp;&amp; validator.<span class="keyword">next</span>() : s</span><br><span class="line">        s = s ? vali.email &amp;&amp; validator.<span class="keyword">next</span>() : s</span><br><span class="line">        !s &amp;&amp; e.preventDefault()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>// 优缺点：条件和对象本身完全隔离开,后续代码的维护,代码整洁度,以及代码健壮性和复用性变得非常强，缺点是兼容性不好，但可以通过使用Babel来进行代码转换</p>
<h4 id="获取滚动条距离顶部的距离"><a href="#获取滚动条距离顶部的距离" class="headerlink" title="获取滚动条距离顶部的距离"></a>获取滚动条距离顶部的距离</h4><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">const getScrollTop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取当前可视范围的高度"><a href="#获取当前可视范围的高度" class="headerlink" title="获取当前可视范围的高度"></a>获取当前可视范围的高度</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> getClientHeight = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> clientHeight = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.body.clientHeight &amp;&amp; <span class="built_in">document</span>.documentElement.clientHeight) &#123;</span><br><span class="line">    clientHeight = <span class="built_in">Math</span>.min(<span class="built_in">document</span>.body.clientHeight, <span class="built_in">document</span>.documentElement.clientHeight)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    clientHeight = <span class="built_in">Math</span>.max(<span class="built_in">document</span>.body.clientHeight, <span class="built_in">document</span>.documentElement.clientHeight)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> clientHeight</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取文档完整的高度，包括超出屏幕可以滚动显示的部分"><a href="#获取文档完整的高度，包括超出屏幕可以滚动显示的部分" class="headerlink" title="获取文档完整的高度，包括超出屏幕可以滚动显示的部分"></a>获取文档完整的高度，包括超出屏幕可以滚动显示的部分</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> getScrollHeight = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.max(<span class="built_in">document</span>.body.scrollHeight, <span class="built_in">document</span>.documentElement.scrollHeight)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="移动端浮层滚动的同时阻止背后-document的整个滚动-重点使用频率高，很高"><a href="#移动端浮层滚动的同时阻止背后-document的整个滚动-重点使用频率高，很高" class="headerlink" title="移动端浮层滚动的同时阻止背后 document的整个滚动(重点使用频率高，很高)"></a>移动端浮层滚动的同时阻止背后 document的整个滚动(重点使用频率高，很高)</h4><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* CSS */</span></span><br><span class="line">.noscroll, .noscroll body &#123;</span><br><span class="line">    overflow:hidden;</span><br><span class="line">&#125;</span><br><span class="line">.noscroll body &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关键 JS代码, 非原生JS，基于 zepto 或者 jQuery实现</span></span><br><span class="line">$.smartScroll = function(container, selectorScrollable) &#123;</span><br><span class="line"><span class="comment">// 如果没有滚动容器选择器，或者已经绑定了滚动事件，忽略</span></span><br><span class="line"><span class="keyword">if</span> (!selectorScrollable || container.<span class="keyword">data</span>(<span class="string">'isBindScroll'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否是浏览器</span></span><br><span class="line"><span class="comment">// 自己在这里添加判断和筛选</span></span><br><span class="line"><span class="keyword">var</span> isSBBrowser;</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">data</span> = &#123;</span><br><span class="line">    posY: <span class="number">0</span>,</span><br><span class="line">    maxscroll: <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 事件处理</span></span><br><span class="line">container.on(&#123;</span><br><span class="line">    touchstart: function (event) &#123;</span><br><span class="line">        <span class="keyword">var</span> events = event.touches[<span class="number">0</span>] || event;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 先求得是不是滚动元素或者滚动元素的子元素</span></span><br><span class="line">        <span class="keyword">var</span> elTarget = $(event.target);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!elTarget.length) &#123;</span><br><span class="line">            <span class="keyword">return</span>;    </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> elScroll;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取标记的滚动元素，自身或子元素皆可</span></span><br><span class="line">        <span class="keyword">if</span> (elTarget.<span class="keyword">is</span>(selectorScrollable)) &#123;</span><br><span class="line">            elScroll = elTarget;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((elScroll = elTarget.parents(selectorScrollable)).length == <span class="number">0</span>) &#123;</span><br><span class="line">            elScroll = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!elScroll) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 当前滚动元素标记</span></span><br><span class="line">        <span class="keyword">data</span>.elScroll = elScroll;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 垂直位置标记</span></span><br><span class="line">        <span class="keyword">data</span>.posY = events.pageY;</span><br><span class="line">        <span class="keyword">data</span>.scrollY = elScroll.scrollTop();</span><br><span class="line">        <span class="comment">// 是否可以滚动</span></span><br><span class="line">        <span class="keyword">data</span>.maxscroll = elScroll[<span class="number">0</span>].scrollHeight - elScroll[<span class="number">0</span>].clientHeight;</span><br><span class="line">    &#125;,</span><br><span class="line">    touchmove: function () &#123;</span><br><span class="line">        <span class="comment">// 如果不足于滚动，则禁止触发整个窗体元素的滚动</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">data</span>.maxscroll &lt;= <span class="number">0</span> || isSBBrowser) &#123;</span><br><span class="line">            <span class="comment">// 禁止滚动</span></span><br><span class="line">            event.preventDefault();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 滚动元素</span></span><br><span class="line">        <span class="keyword">var</span> elScroll = <span class="keyword">data</span>.elScroll;</span><br><span class="line">        <span class="comment">// 当前的滚动高度</span></span><br><span class="line">        <span class="keyword">var</span> scrollTop = elScroll.scrollTop();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 现在移动的垂直位置，用来判断是往上移动还是往下</span></span><br><span class="line">        <span class="keyword">var</span> events = event.touches[<span class="number">0</span>] || event;</span><br><span class="line">        <span class="comment">// 移动距离</span></span><br><span class="line">        <span class="keyword">var</span> distanceY = events.pageY - <span class="keyword">data</span>.posY;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isSBBrowser) &#123;</span><br><span class="line">            elScroll.scrollTop(<span class="keyword">data</span>.scrollY - distanceY);</span><br><span class="line">            elScroll.trigger(<span class="string">'scroll'</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 上下边缘检测</span></span><br><span class="line">        <span class="keyword">if</span> (distanceY &gt; <span class="number">0</span> &amp;&amp; scrollTop == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 往上滑，并且到头</span></span><br><span class="line">            <span class="comment">// 禁止滚动的默认行为</span></span><br><span class="line">            event.preventDefault();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 下边缘检测</span></span><br><span class="line">        <span class="keyword">if</span> (distanceY &lt; <span class="number">0</span> &amp;&amp; (scrollTop + <span class="number">1</span> &gt;= <span class="keyword">data</span>.maxscroll)) &#123;</span><br><span class="line">            <span class="comment">// 往下滑，并且到头</span></span><br><span class="line">            <span class="comment">// 禁止滚动的默认行为</span></span><br><span class="line">            event.preventDefault();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    touchend: function () &#123;</span><br><span class="line">        <span class="keyword">data</span>.maxscroll = <span class="number">0</span>;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 防止多次重复绑定</span></span><br><span class="line">container.<span class="keyword">data</span>(<span class="string">'isBindScroll'</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="自定义滚动条相关的七个伪元素"><a href="#自定义滚动条相关的七个伪元素" class="headerlink" title="自定义滚动条相关的七个伪元素"></a>自定义滚动条相关的七个伪元素</h4><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="symbol">:</span><span class="symbol">:-webkit-scrollbar</span>：整个滚动条</span><br><span class="line"><span class="symbol">:</span><span class="symbol">:-webkit-scrollbar-button</span>：滚动条上的按钮（下下箭头）</span><br><span class="line"><span class="symbol">:</span><span class="symbol">:-webkit-scrollbar-thumb</span>：滚动条上的滚动滑块</span><br><span class="line"><span class="symbol">:</span><span class="symbol">:-webkit-scrollbar-track</span>：滚动条轨道</span><br><span class="line"><span class="symbol">:</span><span class="symbol">:-webkit-scrollbar-track-piece</span>：滚动条没有滑块的轨道部分</span><br><span class="line"><span class="symbol">:</span><span class="symbol">:-webkit-scrollbar-corner</span>：当同时有垂直和水平滚动条时交汇的部分</span><br><span class="line"><span class="symbol">:</span><span class="symbol">:-webkit-resizer</span>：某些元素的交汇部分的部分样式（类似 textarea的可拖动按钮）</span><br></pre></td></tr></table></figure>
<h4 id="16进制颜色代码生成"><a href="#16进制颜色代码生成" class="headerlink" title="16进制颜色代码生成"></a>16进制颜色代码生成</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createColor</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'#'</span> + (<span class="string">'00000'</span> + (<span class="built_in">Math</span>.random() * <span class="number">0x1000000</span> &lt;&lt; <span class="number">0</span>).toString(<span class="number">16</span>)).slice(<span class="number">-6</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="驼峰命名转下划线"><a href="#驼峰命名转下划线" class="headerlink" title="驼峰命名转下划线"></a>驼峰命名转下划线</h4><figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">camel2Underline</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name.match(<span class="regexp">/[a-z][0-9]+|[A-Z][a-z0-9]*/g</span>).join(<span class="string">'_'</span>).toLowerCase()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="日期格式化"><a href="#日期格式化" class="headerlink" title="日期格式化"></a>日期格式化</h4><ul>
<li>版本1<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">function format1(<span class="meta">x</span>, y) &#123;</span><br><span class="line">    var z = &#123;</span><br><span class="line">    y: <span class="meta">x</span>.getFul<span class="meta">lYear(</span>),</span><br><span class="line">    M: <span class="meta">x</span>.ge<span class="meta">tMonth(</span>) + 1,</span><br><span class="line">    d: <span class="meta">x</span>.ge<span class="meta">tDate(</span>),</span><br><span class="line">    h: <span class="meta">x</span>.getHours(),</span><br><span class="line">    m: <span class="meta">x</span>.getMinutes(),</span><br><span class="line">    s: <span class="meta">x</span>.getSeconds()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">return</span> y.<span class="meta">replace</span>(/(y+|M+|d+|h+|m+|s+)/g, functi<span class="meta">on(</span>v) &#123;</span><br><span class="line">    <span class="meta">return</span> ((v.<span class="meta">length</span> &gt; 1 ? <span class="string">'0'</span> : <span class="string">''</span>) + z[v.slice(-1)]).slice(-(v.<span class="meta">length</span> &gt; 2 ? v.<span class="meta">length</span> : 2))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>版本2<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Date</span>.prototype.format2 = <span class="function"><span class="keyword">function</span>(<span class="params">fmt</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = &#123;</span><br><span class="line">        <span class="string">"M+"</span>: <span class="keyword">this</span>.getMonth() + <span class="number">1</span>, <span class="comment">//月份 </span></span><br><span class="line">        <span class="string">"d+"</span>: <span class="keyword">this</span>.getDate(), <span class="comment">//日 </span></span><br><span class="line">        <span class="string">"h+"</span>: <span class="keyword">this</span>.getHours(), <span class="comment">//小时 </span></span><br><span class="line">        <span class="string">"m+"</span>: <span class="keyword">this</span>.getMinutes(), <span class="comment">//分 </span></span><br><span class="line">        <span class="string">"s+"</span>: <span class="keyword">this</span>.getSeconds(), <span class="comment">//秒 </span></span><br><span class="line">        <span class="string">"q+"</span>: <span class="built_in">Math</span>.floor((<span class="keyword">this</span>.getMonth() + <span class="number">3</span>) / <span class="number">3</span>), <span class="comment">//季度 </span></span><br><span class="line">        <span class="string">"S"</span>: <span class="keyword">this</span>.getMilliseconds() <span class="comment">//毫秒 </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.test(fmt)) &#123;</span><br><span class="line">        <span class="comment">// 这里 RegExp的用法挺有意思的</span></span><br><span class="line">        fmt = fmt.replace(<span class="built_in">RegExp</span>.$<span class="number">1</span>, (<span class="keyword">this</span>.getFullYear() + <span class="string">''</span>).substr(<span class="number">4</span> - <span class="built_in">RegExp</span>.$<span class="number">1.</span>length))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'('</span> + k + <span class="string">')'</span>).test(fmt)) &#123;</span><br><span class="line">            fmt = fmt.replace(<span class="built_in">RegExp</span>.$<span class="number">1</span>, (<span class="built_in">RegExp</span>.$<span class="number">1.</span>length === <span class="number">1</span>) ? o[k] : (<span class="string">'00'</span> + o[k]).substr((<span class="string">''</span> + o[k]).length))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fmt</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>使用<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line">format1(<span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="string">'yy-MM-dd hh:m:ss'</span>)  <span class="comment">// 18-08-23 11:46:11</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>().format2(<span class="string">'yyyy-M-d h:m:s'</span>)  <span class="comment">// 2018-8-23 11:46:11</span></span><br></pre></td></tr></table></figure>
<h4 id="数字四舍五入"><a href="#数字四舍五入" class="headerlink" title="数字四舍五入"></a>数字四舍五入</h4><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">//</span> <span class="attr">v:</span> <span class="string">值，</span> <span class="attr">p:</span> <span class="string">精度</span></span><br><span class="line"><span class="string">function</span> <span class="string">round(v,</span> <span class="string">p)</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="string">p</span> <span class="string">=</span> <span class="string">Math.pow(10,</span> <span class="string">p</span> <span class="string">&gt;&gt;&gt;</span> <span class="number">31</span> <span class="string">?</span> <span class="attr">0 :</span> <span class="string">p</span> <span class="string">|</span> <span class="number">0</span><span class="string">)</span></span><br><span class="line">    <span class="string">v</span> <span class="string">*=</span> <span class="string">p</span></span><br><span class="line">    <span class="string">return</span> <span class="string">(v</span> <span class="string">+</span> <span class="number">0.5</span> <span class="string">+</span> <span class="string">(v</span> <span class="string">&gt;&gt;</span> <span class="number">31</span><span class="string">)</span> <span class="string">|</span> <span class="number">0</span><span class="string">)</span> <span class="string">/</span> <span class="string">p</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">//</span> <span class="string">使用</span></span><br><span class="line"><span class="string">round(123.456788,</span> <span class="number">2</span><span class="string">)</span>  <span class="string">//</span> <span class="number">123.46</span></span><br></pre></td></tr></table></figure>
<h4 id="浏览器原生-Base64编码和解码方法"><a href="#浏览器原生-Base64编码和解码方法" class="headerlink" title="浏览器原生 Base64编码和解码方法"></a>浏览器原生 Base64编码和解码方法</h4>  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">支持度为 IE10+，其他主流浏览器完全支持</span><br><span class="line"></span><br><span class="line">编码(btoa):</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.btoa(stringToEncode)</span><br><span class="line">解码(atob)：</span><br><span class="line"></span><br><span class="line"><span class="comment">// encodedData 代表 base64字符串</span></span><br><span class="line"><span class="built_in">window</span>.atob(encodedData)</span><br><span class="line">对中文进行编码会报错，可以先将中文转码，再进行编码，解码同样如此：</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.btoa(<span class="built_in">window</span>.encodeURIComponent(<span class="string">'嘻嘻哈哈'</span>))</span><br><span class="line"><span class="built_in">window</span>.atob(<span class="built_in">window</span>.decodeURIComponent(<span class="string">'JUU1JTk4JUJCJUU1JTk4JUJCJUU1JTkzJTg4JUU1JTkzJTg4'</span>))</span><br><span class="line">如果 IE9-浏览器需要此功能，可使用 polyfill， 然后像下面这样引入即可：</span><br><span class="line"></span><br><span class="line">&lt;!--[<span class="keyword">if</span> IE]&gt;</span><br><span class="line">&lt;script src=<span class="string">"./base64-polyfill.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;![endif]--&gt;</span><br><span class="line">任意文件也可以使用此 api进行编码和解码，使用 FileReader:</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">reader.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// e.target.result就是该文件的完整Base64 Data-URI</span></span><br><span class="line">&#125;;</span><br><span class="line">reader.readAsDataURL(file);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="利用委托冒泡，检测ul下被点击的li标签"><a href="#利用委托冒泡，检测ul下被点击的li标签" class="headerlink" title="利用委托冒泡，检测ul下被点击的li标签"></a>利用委托冒泡，检测ul下被点击的li标签</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> oUl = <span class="built_in">document</span>.getElementById(<span class="string">"ul"</span>);</span><br><span class="line">    <span class="keyword">var</span> aLi = oUl.getElementsByTagName(<span class="string">"li"</span>);</span><br><span class="line">    oUl.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">var</span> ev = ev || <span class="built_in">window</span>.event;</span><br><span class="line">    <span class="keyword">var</span> target = ev.target || ev.srcElement;</span><br><span class="line">        <span class="keyword">if</span>(target.nodeName.toLowerCase() == <span class="string">"li"</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> that=target;</span><br><span class="line">        <span class="keyword">var</span> index;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;aLi.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(aLi[i]===target)&#123;</span><br><span class="line">            index=i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(index&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            alert(<span class="string">'我的下标是：'</span>+index);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="直接把函数赋值给变量"><a href="#直接把函数赋值给变量" class="headerlink" title="直接把函数赋值给变量"></a>直接把函数赋值给变量</h4><pre><code>- 凡是使用 return 返回函数调用的(也就是回调)，都可以去掉这个间接包裹层，最终连参数和括号一起去掉
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> getServerStuff = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ajaxCall(<span class="function"><span class="keyword">function</span><span class="params">(json)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> callback(json)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上述代码等价于下面这句：</span></span><br><span class="line"><span class="keyword">const</span> getServerStuff = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ajaxCall(callback)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 上述代码等价于下面这句：</span></span><br><span class="line"><span class="keyword">const</span> getServerStuff = ajaxCall</span><br></pre></td></tr></table></figure></code></pre><h4 id="遍历对象"><a href="#遍历对象" class="headerlink" title="遍历对象"></a>遍历对象</h4><pre><code>当使用 for in 循环遍历对象的属性时，原型链上的所有属性都将被访问，同时如果遍历的是数组，
遍历顺序有可能不是按照实际数组的内部顺序，因此如果遍历数组，尽可能使用传统的 for 循环</code></pre><h4 id="hasOwnProperty-NaN"><a href="#hasOwnProperty-NaN" class="headerlink" title="hasOwnProperty"></a>hasOwnProperty</h4><pre><code>当检查对象上某个属性是否存在时，hasOwnProperty 是唯一可用的方法。 同时在使用 for in遍历对象时，
推荐总是使用 hasOwnProperty 方法，这将会避免原型对象扩展带来的干扰。</code></pre><h4 id="创建数组"><a href="#创建数组" class="headerlink" title="创建数组"></a>创建数组</h4><pre><code>应该尽量避免使用数组构造函数创建新数组。推荐使用数组的字面语法。它们更加短小和简洁，因此增加了代码的可读性。</code></pre><h4 id="检测对象的类型"><a href="#检测对象的类型" class="headerlink" title="检测对象的类型"></a>检测对象的类型</h4><pre><code>为了检测一个对象的类型，强烈推荐使用 Object.prototype.toString 方法； 因为这是唯一一个可依赖的方式。</code></pre><h4 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h4><pre><code>instanceof 操作符应该仅仅用来比较来自同一个 JavaScript 上下文的自定义对象。
 正如 typeof 操作符一样，任何其它的用法都应该是避免的。</code></pre><h4 id="手工清空定时器"><a href="#手工清空定时器" class="headerlink" title="手工清空定时器"></a>手工清空定时器</h4><pre><code><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="string">//</span> 每个<span class="keyword">set</span>Timeout 都会返回一个 ID 标识</span><br><span class="line">var id = <span class="keyword">set</span>Timeout<span class="params">(foo, 1000)</span>;</span><br><span class="line"><span class="keyword">clear</span>Timeout<span class="params">(id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="string">//</span> 清空<span class="string">"所有"</span>的定时器</span><br><span class="line">for<span class="params">(var <span class="attr">i</span> = 1; i &lt; 1000; i++)</span> &#123;</span><br><span class="line">    <span class="keyword">clear</span>Timeout<span class="params">(i)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h4 id="优化选择器"><a href="#优化选择器" class="headerlink" title="优化选择器"></a>优化选择器</h4><pre><code><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">选择器以 ID 开始总是最好的。</span><br><span class="line"><span class="comment">//  快</span></span><br><span class="line"><span class="constructor">$('#<span class="params">container</span> <span class="params">div</span>.<span class="params">robotarm</span>')</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 非常快</span></span><br><span class="line"><span class="constructor">$('#<span class="params">container</span>')</span>.find('div.robotarm');</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 $.fn.find 的方式会更快是因为在第一步里只有 ID，</span></span><br><span class="line"> 根本没用到快速选择器引擎，而是使用了浏览器内置的极速的 document.get<span class="constructor">ElementById()</span>。</span><br><span class="line">选择器的右侧部分应该尽可能具体，左侧则不需要那么具体</span><br><span class="line"><span class="comment">//未优化的</span></span><br><span class="line"><span class="constructor">$('<span class="params">div</span>.<span class="params">data</span> .<span class="params">gonzalez</span>')</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化过的</span></span><br><span class="line"><span class="constructor">$('.<span class="params">data</span> <span class="params">td</span>.<span class="params">gonzalez</span>')</span>;</span><br><span class="line">避免使用无定向选择器</span><br><span class="line"><span class="constructor">$('.<span class="params">buttons</span> &gt; <span class="operator">*</span>')</span>;  <span class="comment">// 极慢</span></span><br><span class="line"><span class="constructor">$('.<span class="params">buttons</span>')</span>.children<span class="literal">()</span>;  <span class="comment">// 快很多</span></span><br><span class="line"></span><br><span class="line"><span class="constructor">$('.<span class="params">gender</span> :<span class="params">radio</span>')</span>;  <span class="comment">// 暗示这是一个无定向的搜索</span></span><br><span class="line"><span class="constructor">$('.<span class="params">gender</span> <span class="operator">*</span>:<span class="params">radio</span>')</span>; <span class="comment">// 同上，这只不过是说出来了</span></span><br><span class="line"><span class="constructor">$('.<span class="params">gender</span> <span class="params">input</span>:<span class="params">radio</span>')</span>; <span class="comment">// 这就差不多了</span></span><br></pre></td></tr></table></figure></code></pre><h4 id="使用事件委派"><a href="#使用事件委派" class="headerlink" title="使用事件委派"></a>使用事件委派</h4><pre><code><figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 如果列表里面元素很多，不堪想象</span></span><br><span class="line">$(<span class="string">'li.trigger'</span>).click(handlerFn);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这样写好一点，用 $.fn.live 做事件委派</span></span><br><span class="line">$(<span class="string">'li.trigger'</span>).live(<span class="string">'click'</span>, handlerFn);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最好的做法，用 $.fn.delegate 做事件委派，还可以指定一个上下文</span></span><br><span class="line">$(<span class="string">'#myList'</span>).delegate(<span class="string">'li.trigger'</span>, <span class="string">'click'</span>, handlerFn);</span><br><span class="line"><span class="comment">// 先将元素 detach 出来再操作</span></span><br><span class="line"><span class="comment">// DOM 操作是慢的，你应该尽量避免去操作它。 </span></span><br><span class="line">jQuery 在 <span class="number">1.4</span> 版引入了 $.fn.detach 来帮助解决这个问题：让你可以先将元素从 DOM 树中剥离出来再进行操作。</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="symbol">$ta</span>ble = $(<span class="string">'#myTable'</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="symbol">$pare</span>nt = <span class="symbol">$ta</span>ble.parent();</span><br><span class="line"></span><br><span class="line"><span class="symbol">$ta</span>ble.detach();</span><br><span class="line"><span class="comment">// ... 添加大量的行到表格中去</span></span><br><span class="line"><span class="symbol">$pare</span>nt.append(table);</span><br><span class="line">应该使用样式表给大量元素修改 CSS</span><br><span class="line">如果你在用 $.fn.css 给多于 <span class="number">20</span> 个元素修改 CSS，考虑一下添加一个 style 标签，</span><br><span class="line"> 这样可以速度可以提升 <span class="number">60</span>%。 操作大于 <span class="number">20</span> 个元素是不错的，但少于时就不值了</span><br><span class="line"></span><br><span class="line"><span class="comment">// 少量css操作</span></span><br><span class="line">$(<span class="string">'a.swedberg'</span>).css(<span class="string">'color'</span>, <span class="string">'#asd123'</span>);</span><br><span class="line"><span class="comment">// 大量css操作，最好使用样式表</span></span><br><span class="line">$(<span class="string">'&lt;style type="text/css"&gt;a.swedberg &#123; color : #asd123 &#125;&lt;/style&gt;'</span>).appendTo(<span class="string">'head'</span>);</span><br><span class="line">使用 $.data 而不是 $.fn.data</span><br><span class="line"><span class="comment">// 常规写法</span></span><br><span class="line">$(elem).data(key,value);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 快 10 倍</span></span><br><span class="line">$.data(elem,key,value);</span><br><span class="line">别费时间在空白的选择结果上了</span><br><span class="line"><span class="comment">// 太糟了，执行了三个方法后才意识到里面是空的</span></span><br><span class="line">$(<span class="string">'#nosuchthing'</span>).slideUp();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这会好点，就是代码有点长</span></span><br><span class="line"><span class="keyword">var</span> <span class="symbol">$my</span>Selection = $(<span class="string">'#nosuchthing'</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="symbol">$my</span>Selection.length) &#123; mySelection.slideUp(); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最好的做法是添加一个 doOnce 插件</span></span><br><span class="line">jQuery.fn.doOnce = <span class="function"><span class="keyword">function</span>(<span class="params">func</span>)</span>&#123; </span><br><span class="line">    this.length &amp;&amp; func.apply(this);</span><br><span class="line">    <span class="keyword">return</span> this; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(<span class="string">'li.cartitems'</span>).doOnce(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    <span class="comment">// make it ajax! \o/</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></code></pre><h4 id="判定-IE7"><a href="#判定-IE7" class="headerlink" title="判定 IE7-"></a>判定 IE7-</h4><pre><code>// 其中 &apos;p&apos;[0]，`p`可以换成任何单字符，如果原样返回这个字符，则说明是 IE8+，
否则返回 undefined 则表明是 IE7-
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">'p'</span>[<span class="number">0</span>])&#123;</span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">"It\'s IE8+"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">"It\'s IE7-"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h4 id="处理大量的数据"><a href="#处理大量的数据" class="headerlink" title="处理大量的数据"></a>处理大量的数据</h4><pre><code>将数据的数据量很大，一次性处理这些数据所需花费的时间较长，并且可能导致诸如浏览器暂时失去响应的结果，
 那么最好将这些数据分割成数个小的 “进程”，利用事件轮询来取得一个更加流畅的效果。

使用 setTimeout（黑科技）来异步排程，基本上它的意思是“将这个函数贴在事件轮询队列的末尾”。

下面这些是一般处理数据的方法，当数据量很大时，可能导致浏览器失去响应：
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> res = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">// `response(..)`从Ajax调用收到一个结果数组</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">(data)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 连接到既存的`res`数组上</span></span><br><span class="line">    res = res.concat(</span><br><span class="line">        <span class="comment">// 制造一个新的变形过的数组，所有的`data`值都翻倍</span></span><br><span class="line">        data.map( <span class="function"><span class="keyword">function</span><span class="params">(val)</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> val * <span class="number">2</span>;</span><br><span class="line">        &#125; )</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ajax(..) 是某个包中任意的Ajax函数</span></span><br><span class="line">ajax( <span class="string">"http://some.url.1"</span>, response );</span><br><span class="line">ajax( <span class="string">"http://some.url.2"</span>, response );</span><br><span class="line">最好使用以下写法，利用 setTimeout 来将处理数据的过程，分割成数个小的“进程”：</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> res = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">// `response(..)`从Ajax调用收到一个结果数组</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">(data)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 我们一次只处理1000件</span></span><br><span class="line">    <span class="keyword">var</span> chunk = data.splice( <span class="number">0</span>, <span class="number">1000</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 连接到既存的`res`数组上</span></span><br><span class="line">    res = res.concat(</span><br><span class="line">        <span class="comment">// 制造一个新的变形过的数组，所有的`data`值都翻倍</span></span><br><span class="line">        chunk.map( <span class="function"><span class="keyword">function</span><span class="params">(val)</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> val * <span class="number">2</span>;</span><br><span class="line">        &#125; )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 还有东西要处理吗？</span></span><br><span class="line">    <span class="keyword">if</span> (data.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 异步规划下一个批处理，将剩余的数据追加到下一个事件轮询队列中</span></span><br><span class="line">        setTimeout( <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">            response( data );</span><br><span class="line">        &#125;, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ajax(..) 是某个包中任意的Ajax函数</span></span><br><span class="line">ajax( <span class="string">"http://some.url.1"</span>, response );</span><br><span class="line">ajax( <span class="string">"http://some.url.2"</span>, response );</span><br></pre></td></tr></table></figure></code></pre><h4 id="字符输出"><a href="#字符输出" class="headerlink" title="字符输出"></a>字符输出</h4><pre><code>HTML中字符输出使用&amp;#x配上 charCode值；
在JavaScript文件中为防止乱码转义，则是 \u配上 charCode值；
而在 CSS文件中，如 CSS伪元素的 content属性，直接使用 \配上 charCode值。
因此，想在 HTML/JS/CSS中转义“我”这个汉字，分别是：

&amp;#x6211;
\u6211, 如console.log(&apos;\u6211&apos;)
\6211, 如.xxx:before { content: &apos;\6211&apos;; }
使用 js获取字符 charCode方法：

// 例如获取 `好`的 charCode
&apos;你好&apos;.charCodeAt(1).toString(16)
考虑到直接 &amp;#x3000;这种形式暴露在HTML中，可能会让屏幕阅读器等辅助设备读取，从而影响正常阅读流，
因此， 我们可以进一步优化下，使用标签，利用伪元素，例如：

.full:before { content: &apos;\2003&apos;; speak: none; }
这样，占位的空格字符即不能读，也不能选了。</code></pre><h4 id="CSS中层叠上下文顺序"><a href="#CSS中层叠上下文顺序" class="headerlink" title="CSS中层叠上下文顺序"></a>CSS中层叠上下文顺序</h4><h5 id="由上到下，层次依次递减"><a href="#由上到下，层次依次递减" class="headerlink" title="由上到下，层次依次递减"></a>由上到下，层次依次递减</h5><pre><code><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 正z-index</span></span><br><span class="line"><span class="comment">// z-index:auto / z-index:0 / 不依赖 z-index的层叠上下文</span></span><br><span class="line"><span class="comment">// inline/inline-block水平盒子</span></span><br><span class="line"><span class="comment">// float浮动盒子</span></span><br><span class="line"><span class="comment">// block块状水平盒子</span></span><br><span class="line"><span class="comment">// 负z-index</span></span><br><span class="line"><span class="comment">// 层叠上下文background / border</span></span><br><span class="line"><span class="comment">// 异常捕获</span></span><br><span class="line"><span class="comment">// try...catch</span></span><br><span class="line"><span class="comment">// 使用try catch能够很好的捕获异常并对应进行相应处理，不至于让页面挂掉，但是其存在一些弊端，</span></span><br><span class="line">比如需要在捕获异常的代码上进行包裹，会导致页面臃肿不堪，不适用于整个项目的异常捕获。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onerror</span><br><span class="line"><span class="built_in">window</span>.onerror提供了全局监听异常的功能，不过可能会存在以下问题：</span><br><span class="line"></span><br><span class="line">Script error <span class="built_in">window</span>.onerror无法准确捕获到跨域资源的异常信息，例如 CDN上的静态资源，</span><br><span class="line">只会统一返回 Script error 解决方案： script标签配置 crossorigin=<span class="string">"anonymous"</span></span><br><span class="line"> 并且服务器添加 Access-Control-Allow-Origin: *(一般 CDN服务器都会配置此属性):</span><br><span class="line"><span class="comment">//&lt;script src="http://cdn.xxx.com/index.js" crossorigin="anonymous"&gt;</span></span><br><span class="line">sourceMap</span><br><span class="line">线上代码一般是混淆压缩的，无法正确清晰地定位报错代码的位置，所以需要启用 sourceMap，例如，在 webpack打包工具中启用：</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    devtool: <span class="string">'#source-map'</span>,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MVVM框架中的异常捕获</span><br><span class="line">一般的 MVVM框架自带异常捕获机制，并且通常会屏蔽外部添加的异常捕获代码，例如 <span class="built_in">window</span>.onerror。</span><br><span class="line"></span><br><span class="line">下面是 vue2.x中捕获全局异常的方法：</span><br><span class="line"></span><br><span class="line">Vue.config.errorHandler = <span class="function"><span class="keyword">function</span> (<span class="params">err, vm, info</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; </span><br><span class="line">        message, <span class="comment">// 异常信息</span></span><br><span class="line">        name, <span class="comment">// 异常名称</span></span><br><span class="line">        script,  <span class="comment">// 异常脚本url</span></span><br><span class="line">        line,  <span class="comment">// 异常行号</span></span><br><span class="line">        column,  <span class="comment">// 异常列号</span></span><br><span class="line">        stack  <span class="comment">// 异常堆栈信息</span></span><br><span class="line">    &#125; = err;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// vm为抛出异常的 Vue 实例</span></span><br><span class="line">    <span class="comment">// info为 Vue 特定的错误信息，比如错误所在的生命周期钩子</span></span><br><span class="line">    <span class="comment">// 只在 2.2.0+ 可用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h4 id="异常上报"><a href="#异常上报" class="headerlink" title="异常上报"></a>异常上报</h4><pre><code>捕获到异常后，需要进行上报，这一步比较简单，例如直接将捕获到的错误通过 ajax全部上传即可。

sourceMap 异常解析
上传的错误日志可能是混淆加密后的代码的错误日志，不好分析，
所以还需要使用 soureMap分析工具对其进行解析。 这样的工具，例如 source-map</code></pre><h4 id="深度判等"><a href="#深度判等" class="headerlink" title="深度判等"></a>深度判等</h4><pre><code>- 两个对象结构和数据完全一致，即认为相等，而不要求是同一引用
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">deepEqual</span> (<span class="params">o1, o2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> o1 !== <span class="string">'object'</span> || <span class="keyword">typeof</span> o2 !== <span class="string">'object'</span>) &#123; <span class="keyword">return</span> o1 === o2 &#125;</span><br><span class="line">    <span class="comment">// 完全遍历 o1,保证 o2 的数据结构可以覆盖 o1的，也就是说 o2的数据结构大于等于 o1的</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> o1) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!deepEqual(o1[p], o2[p])) &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 保证 o2中存在的数据结构在 o1中也存在，结合上一步，即可证明二者数据结构完全一致</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> q <span class="keyword">in</span> o2) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!(q <span class="keyword">in</span> o1)) &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h4 id="深度覆盖"><a href="#深度覆盖" class="headerlink" title="深度覆盖"></a>深度覆盖</h4><pre><code>- 将源对象的值覆盖目标对象，相同结构相同参数部分直接覆盖，其它部分保持不变，例如： 修改前：
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">target = &#123;x: <span class="number">1</span>, y: &#123;a: <span class="number">1</span>, b:<span class="number">1</span> &#125;, z: <span class="number">1</span>&#125;;</span><br><span class="line">source = &#123;x: <span class="number">2</span>, y: &#123;a: <span class="number">2</span>&#125;&#125;;</span><br><span class="line">修改后：</span><br><span class="line"></span><br><span class="line">target = &#123;x: <span class="number">2</span>, y: &#123;a: <span class="number">2</span>, b:<span class="number">1</span> &#125;, z: <span class="number">1</span>&#125;</span><br><span class="line">实现：</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepAssign</span> <span class="params">(target, <span class="rest_arg">...sources</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">'object'</span>) &#123;</span><br><span class="line">    console.error(<span class="string">'[deepAssign] bad parameters, target should be an object, parameters:'</span>, arguments)</span><br><span class="line">    <span class="keyword">return</span> target</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (let source of sources) &#123;</span><br><span class="line">    <span class="keyword">if</span> (source != <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> source !== <span class="string">'object'</span>) &#123;</span><br><span class="line">        console.warn(<span class="string">'[deepAssign] bad parameters, source should all be object, parameters:'</span>, arguments)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> target[p] === <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> source[p] === <span class="string">'object'</span>) &#123; deepAssign(target[p], source[p]) &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123; target[p] = source[p] &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> target</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h4 id="监控网页的崩溃"><a href="#监控网页的崩溃" class="headerlink" title="监控网页的崩溃"></a>监控网页的崩溃</h4><p>由于网页崩溃以后，页面上的 js很可能也是无法运行的了，所以无法使用页面上的 js进行网页崩溃的监控，需要另寻他法。<br>1.<a href="https://mp.weixin.qq.com/s/HnMZLI7hZ5sXU7bOXh615A" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/HnMZLI7hZ5sXU7bOXh615A</a><br>2.<a href="https://zhuanlan.zhihu.com/p/40273861" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/40273861</a></p>
<h4 id="解决堆栈"><a href="#解决堆栈" class="headerlink" title="解决堆栈"></a>解决堆栈</h4><h5 id="堆栈溢出一般是由什么原因导致？"><a href="#堆栈溢出一般是由什么原因导致？" class="headerlink" title="堆栈溢出一般是由什么原因导致？"></a>堆栈溢出一般是由什么原因导致？</h5><ul>
<li><p>1.没有回收垃圾资源</p>
</li>
<li><p>2.层次太深的递归调用</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> nextListItem = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 假设 list是一个已经存在的数组</span></span><br><span class="line">    <span class="keyword">if</span> (list.pop()) &#123;</span><br><span class="line">    nextListItem();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述代码在 list数组长度较大的时候，由于可能会不断地进行回调自身的操作，不断在申请内存用于存放堆栈信息，<br>一直到函数达到一定条件不再进行持续的回调自身，最初的函数才运行结束，释放掉所申请的所有内存，<br>而如果在此期间所申请的总内存超出了线程的栈空间，则将发生栈溢出。</p>
</li>
</ul>
<p>有两种解决方式：</p>
<p>异步</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> nextListItem = () =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>.pop()) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(nextListItem, <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setTimeout</span>的作用就是让代码异步运行，将每次回调自身函数的执行放到事件队列中，</span><br><span class="line">上一个函数执行完就可以退出，释放所占用的内存，不会造成内存累计的情况。</span><br></pre></td></tr></table></figure>
<p>闭包</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> nextListItem = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (list.pop()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nextListItem()</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为了避免不断调用，例如 nextListItem()()()，增加一个自动调用器</span></span><br><span class="line"><span class="keyword">const</span> autoRun = <span class="function"><span class="params">func</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> value = func()</span><br><span class="line">    <span class="keyword">typeof</span> value === <span class="string">'function'</span> &amp;&amp; autoRun(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line">autoRun(nextListItem)</span><br><span class="line">闭包返回的是一个新函数，之前的函数在运行结束后可以释放内存，所以也不存在内存堆积的情况。</span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">爱笑的猫</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.laputcat.top/posts/5066d279.html">https://www.laputcat.top/posts/5066d279.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.laputcat.top" target="_blank">爱笑的猫</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/codeBlock/">codeBlock</a></div><div class="post_share"><div class="social-share" data-image="http://image.laputcat.top/blog/php.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/images/wechatpay.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/images/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/2da0cc6f.html"><img class="prev_cover" data-src="https://i.loli.net/2020/03/20/hDBRKMuCLEp5d7z.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Xampp汇总</div></div></a></div><div class="next-post pull_right"><a href="/posts/593ef122.html"><img class="next_cover" data-src="https://img.php.cn/upload/article/000/000/007/2f6af5226adfeb6e67b09841b303e379.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">centos7 宝塔[LNMP] 访问swoole服务问题</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="lv-container" data-id="city" data-uid="MTAyMC80NDcwNS8yMTIzMQ"><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></article></main><footer id="footer" style="background-image: url(/%EF%BC%88%E9%99%A4%E9%9D%9E%E7%89%B9%E5%AE%9A%E9%9C%80%E8%A6%81%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%B8%8D%E5%AF%AB%EF%BC%89)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 爱笑的猫</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://www.beian.miit.gov.cn/state/outPortal/loginPortal.action#" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>闽ICP备20008453</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode far fa-moon" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
      pangu.spacingElementById('content-inner')
})</script><script src="/js/search/local-search.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":80,"height":100},"mobile":{"show":false},"log":false});</script></body></html>